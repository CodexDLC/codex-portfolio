<!--
    ISLAND SECTION
    Этот блок заменяет содержимое #portfolio-grid.
    Класс "active" нужен для анимации появления (CSS fade-in).
    Класс темы (theme-gold) задает цвета.
-->
<section class="island-section active {{ active_category.theme_class }}" id="current-island">

    <!-- Заголовок секции (из базы) -->
    <div class="island-header">
        <span class="island-title">
            <!-- Цветная цифра -->
            <span class="{{ active_category.tab_icon_class }}">{{ active_category.section_number }} //</span>
            {{ active_category.section_title }}
        </span>
        <span class="island-counter">{{ projects|length }} MODULES</span>
    </div>

    <!-- Сетка карточек -->
    <div class="island-grid">

        {% for project in projects %}
            <!--
                КАРТОЧКА ПРОЕКТА
                Данные приходят из Redis (словарь), поэтому доступ по ключам.
                project.style_visual — строка класса (visual-theme-gold).
                project.layout_class — строка класса (size-xl).
            -->
            <a href="{{ project.link_github|default:'#' }}" class="bento-card {{ project.style_visual }} {{ project.layout_class }}" target="_blank">

                <!-- Хедер карточки -->
                <div class="bento-header">
                    <span class="bento-type">{{ project.project_type }}</span>
                    <!-- Статус (активен/нет) -->
                    <span class="bento-status {% if project.status == 'dev' or project.status == 'prod' %}active{% endif %}"></span>
                </div>

                <!-- Контент -->
                <h3 class="bento-title">{{ project.title }}</h3>
                <p class="bento-desc">{{ project.description|truncatechars:100 }}</p>

                <!-- Теги (внизу) -->
                <div class="bento-tags">
                    {% for tag in project.tags %}
                        <span class="bento-tag" data-category="{{ tag.category }}">{{ tag.name }}</span>
                    {% endfor %}
                </div>
            </a>
        {% empty %}
            <!-- Если проектов нет -->
            <div class="bento-card visual-theme-ghost size-xl">
                <h3 class="bento-title">No Data</h3>
                <p class="bento-desc">No projects found in this category.</p>
            </div>
        {% endfor %}

    </div>
</section>

<!-- Обновление кнопок навигации (OOB Swap) -->
<div id="mobile-slide-controls" hx-swap-oob="true" class="mobile-slide-controls">

    <!-- Кнопка ВВЕРХ -->
    <button id="slide-prev-btn" class="tab control-tab"
            {% if page_obj.has_previous %}
                hx-get="?category={{ active_category.slug }}&page={{ page_obj.previous_page_number }}"
                hx-target="#portfolio-grid"
                hx-swap="innerHTML transition:true"
                title="Previous Slide"
            {% else %}
                disabled style="opacity: 0.3; cursor: default;"
                title="Start"
            {% endif %}>
        <span class="tab-icon">↑</span>
    </button>

    <!-- Кнопка ВНИЗ -->
    <button id="slide-next-btn" class="tab control-tab"
            {% if page_obj.has_next %}
                hx-get="?category={{ active_category.slug }}&page={{ page_obj.next_page_number }}"
                hx-target="#portfolio-grid"
                hx-swap="innerHTML transition:true"
                title="Next Slide"
            {% else %}
                disabled style="opacity: 0.3; cursor: default;"
                title="End"
            {% endif %}>
        <span class="tab-icon">↓</span>
    </button>
</div>